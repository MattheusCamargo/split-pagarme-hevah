(()=>{var e={776:(e,t,n)=>{"use strict";var a=n(143);function r(){}function s(){}s.resetWarningCache=r,e.exports=function(){function e(e,t,n,r,s,o){if(o!==a){var l=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw l.name="Invariant Violation",l}}function t(){return e}e.isRequired=e;var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:s,resetWarningCache:r};return n.PropTypes=n,n}},268:(e,t,n)=>{e.exports=n(776)()},143:e=>{"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},748:(e,t,n)=>{e.exports=n(696)},696:(e,t,n)=>{"use strict";var a,r=(a=n(280))&&"object"==typeof a&&"default"in a?a.default:a,s=n(34);function o(){return(o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var i=function(e,t,n,a,r,s,o,l){if(!e){var i;if(void 0===t)i=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var u=[n,a,r,s,o,l],c=0;(i=new Error(t.replace(/%s/g,(function(){return u[c++]})))).name="Invariant Violation"}throw i.framesToPop=1,i}};function u(e,t,n){if("selectionStart"in e&&"selectionEnd"in e)e.selectionStart=t,e.selectionEnd=n;else{var a=e.createTextRange();a.collapse(!0),a.moveStart("character",t),a.moveEnd("character",n-t),a.select()}}var c={9:"[0-9]",a:"[A-Za-z]","*":"[A-Za-z0-9]"};function d(e,t,n){var a="",r="",s=null,o=[];if(void 0===t&&(t="_"),null==n&&(n=c),!e||"string"!=typeof e)return{maskChar:t,formatChars:n,mask:null,prefix:null,lastEditablePosition:null,permanents:[]};var l=!1;return e.split("").forEach((function(e){l=!l&&"\\"===e||(l||!n[e]?(o.push(a.length),a.length===o.length-1&&(r+=e)):s=a.length+1,a+=e,!1)})),{maskChar:t,formatChars:n,prefix:r,mask:a,lastEditablePosition:s,permanents:o}}function p(e,t){return-1!==e.permanents.indexOf(t)}function m(e,t,n){var a=e.mask,r=e.formatChars;if(!n)return!1;if(p(e,t))return a[t]===n;var s=r[a[t]];return new RegExp(s).test(n)}function f(e,t){return t.split("").every((function(t,n){return p(e,n)||!m(e,n,t)}))}function h(e,t){var n=e.maskChar,a=e.prefix;if(!n){for(;t.length>a.length&&p(e,t.length-1);)t=t.slice(0,t.length-1);return t.length}for(var r=a.length,s=t.length;s>=a.length;s--){var o=t[s];if(!p(e,s)&&m(e,s,o)){r=s+1;break}}return r}function v(e,t){return h(e,t)===e.mask.length}function g(e,t){var n=e.maskChar,a=e.mask,r=e.prefix;if(!n){for((t=b(e,"",t,0)).length<r.length&&(t=r);t.length<a.length&&p(e,t.length);)t+=a[t.length];return t}if(t)return b(e,g(e,""),t,0);for(var s=0;s<a.length;s++)p(e,s)?t+=a[s]:t+=n;return t}function b(e,t,n,a){var r=e.mask,s=e.maskChar,o=e.prefix,l=n.split(""),i=v(e,t);return!s&&a>t.length&&(t+=r.slice(t.length,a)),l.every((function(n){for(;c=n,p(e,u=a)&&c!==r[u];){if(a>=t.length&&(t+=r[a]),l=n,s&&p(e,a)&&l===s)return!0;if(++a>=r.length)return!1}var l,u,c;return!m(e,a,n)&&n!==s||(a<t.length?t=s||i||a<o.length?t.slice(0,a)+n+t.slice(a+1):(t=t.slice(0,a)+n+t.slice(a),g(e,t)):s||(t+=n),++a<r.length)})),t}function k(e,t){for(var n=e.mask,a=t;a<n.length;++a)if(!p(e,a))return a;return null}function w(e){return e||0===e?e+"":""}function C(e){return"function"==typeof e}function I(){return window.cancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame}function y(e){return(I()?window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame:function(){return setTimeout(e,1e3/60)})(e)}function S(e){(I()||clearTimeout)(e)}var E=function(e){function t(t){var n=e.call(this,t)||this;n.focused=!1,n.mounted=!1,n.previousSelection=null,n.selectionDeferId=null,n.saveSelectionLoopDeferId=null,n.saveSelectionLoop=function(){n.previousSelection=n.getSelection(),n.saveSelectionLoopDeferId=y(n.saveSelectionLoop)},n.runSaveSelectionLoop=function(){null===n.saveSelectionLoopDeferId&&n.saveSelectionLoop()},n.stopSaveSelectionLoop=function(){null!==n.saveSelectionLoopDeferId&&(S(n.saveSelectionLoopDeferId),n.saveSelectionLoopDeferId=null,n.previousSelection=null)},n.getInputDOMNode=function(){if(!n.mounted)return null;var e=s.findDOMNode(l(l(n))),t="undefined"!=typeof window&&e instanceof window.Element;if(e&&!t)return null;if("INPUT"!==e.nodeName&&(e=e.querySelector("input")),!e)throw new Error("react-input-mask: inputComponent doesn't contain input node");return e},n.getInputValue=function(){var e=n.getInputDOMNode();return e?e.value:null},n.setInputValue=function(e){var t=n.getInputDOMNode();t&&(n.value=e,t.value=e)},n.setCursorToEnd=function(){var e=h(n.maskOptions,n.value),t=k(n.maskOptions,e);null!==t&&n.setCursorPosition(t)},n.setSelection=function(e,t,a){void 0===a&&(a={});var r=n.getInputDOMNode(),s=n.isFocused();r&&s&&(a.deferred||u(r,e,t),null!==n.selectionDeferId&&S(n.selectionDeferId),n.selectionDeferId=y((function(){n.selectionDeferId=null,u(r,e,t)})),n.previousSelection={start:e,end:t,length:Math.abs(t-e)})},n.getSelection=function(){return function(e){var t=0,n=0;if("selectionStart"in e&&"selectionEnd"in e)t=e.selectionStart,n=e.selectionEnd;else{var a=document.selection.createRange();a.parentElement()===e&&(t=-a.moveStart("character",-e.value.length),n=-a.moveEnd("character",-e.value.length))}return{start:t,end:n,length:n-t}}(n.getInputDOMNode())},n.getCursorPosition=function(){return n.getSelection().start},n.setCursorPosition=function(e){n.setSelection(e,e)},n.isFocused=function(){return n.focused},n.getBeforeMaskedValueChangeConfig=function(){var e=n.maskOptions,t=e.mask,a=e.maskChar,r=e.permanents,s=e.formatChars;return{mask:t,maskChar:a,permanents:r,alwaysShowMask:!!n.props.alwaysShowMask,formatChars:s}},n.isInputAutofilled=function(e,t,a,r){var s=n.getInputDOMNode();try{if(s.matches(":-webkit-autofill"))return!0}catch(e){}return!n.focused||r.end<a.length&&t.end===e.length},n.onChange=function(e){var t=l(l(n)).beforePasteState,a=l(l(n)).previousSelection,r=n.props.beforeMaskedValueChange,s=n.getInputValue(),o=n.value,i=n.getSelection();n.isInputAutofilled(s,i,o,a)&&(o=g(n.maskOptions,""),a={start:0,end:0,length:0}),t&&(a=t.selection,o=t.value,i={start:a.start+s.length,end:a.start+s.length,length:0},s=o.slice(0,a.start)+s+o.slice(a.end),n.beforePasteState=null);var u=function(e,t,n,a,r){var s=e.mask,o=e.prefix,l=e.lastEditablePosition,i=t,u="",c=0,d=0,f=Math.min(r.start,n.start);return n.end>r.start?d=(c=function(e,t,n,a){var r=e.mask,s=e.maskChar,o=n.split(""),l=a;return o.every((function(t){for(;o=t,p(e,n=a)&&o!==r[n];)if(++a>=r.length)return!1;var n,o;return(m(e,a,t)||t===s)&&a++,a<r.length})),a-l}(e,0,u=i.slice(r.start,n.end),f))?r.length:0:i.length<a.length&&(d=a.length-i.length),i=a,d&&(1!==d||r.length||(f=r.start===n.start?k(e,n.start):function(e,t){for(var n=t;0<=n;--n)if(!p(e,n))return n;return null}(e,n.start)),i=function(e,t,n,a){var r=n+a,s=e.maskChar,o=e.mask,l=e.prefix,i=t.split("");if(s)return i.map((function(t,a){return a<n||r<=a?t:p(e,a)?o[a]:s})).join("");for(var u=r;u<i.length;u++)p(e,u)&&(i[u]="");return n=Math.max(l.length,n),i.splice(n,r-n),t=i.join(""),g(e,t)}(e,i,f,d)),i=b(e,i,u,f),(f+=c)>=s.length?f=s.length:f<o.length&&!c?f=o.length:f>=o.length&&f<l&&c&&(f=k(e,f)),u||(u=null),{value:i=g(e,i),enteredString:u,selection:{start:f,end:f}}}(n.maskOptions,s,i,o,a),c=u.enteredString,d=u.selection,f=u.value;if(C(r)){var h=r({value:f,selection:d},{value:o,selection:a},c,n.getBeforeMaskedValueChangeConfig());f=h.value,d=h.selection}n.setInputValue(f),C(n.props.onChange)&&n.props.onChange(e),n.isWindowsPhoneBrowser?n.setSelection(d.start,d.end,{deferred:!0}):n.setSelection(d.start,d.end)},n.onFocus=function(e){var t=n.props.beforeMaskedValueChange,a=n.maskOptions,r=a.mask,s=a.prefix;if(n.focused=!0,n.mounted=!0,r){if(n.value)h(n.maskOptions,n.value)<n.maskOptions.mask.length&&n.setCursorToEnd();else{var o=g(n.maskOptions,s),l=g(n.maskOptions,o),i=h(n.maskOptions,l),u=k(n.maskOptions,i),c={start:u,end:u};if(C(t)){var d=t({value:l,selection:c},{value:n.value,selection:null},null,n.getBeforeMaskedValueChangeConfig());l=d.value,c=d.selection}var p=l!==n.getInputValue();p&&n.setInputValue(l),p&&C(n.props.onChange)&&n.props.onChange(e),n.setSelection(c.start,c.end)}n.runSaveSelectionLoop()}C(n.props.onFocus)&&n.props.onFocus(e)},n.onBlur=function(e){var t=n.props.beforeMaskedValueChange,a=n.maskOptions.mask;if(n.stopSaveSelectionLoop(),n.focused=!1,a&&!n.props.alwaysShowMask&&f(n.maskOptions,n.value)){var r="";C(t)&&(r=t({value:r,selection:null},{value:n.value,selection:n.previousSelection},null,n.getBeforeMaskedValueChangeConfig()).value);var s=r!==n.getInputValue();s&&n.setInputValue(r),s&&C(n.props.onChange)&&n.props.onChange(e)}C(n.props.onBlur)&&n.props.onBlur(e)},n.onMouseDown=function(e){!n.focused&&document.addEventListener&&(n.mouseDownX=e.clientX,n.mouseDownY=e.clientY,n.mouseDownTime=(new Date).getTime(),document.addEventListener("mouseup",(function e(t){if(document.removeEventListener("mouseup",e),n.focused){var a=Math.abs(t.clientX-n.mouseDownX),r=Math.abs(t.clientY-n.mouseDownY),s=Math.max(a,r),o=(new Date).getTime()-n.mouseDownTime;(s<=10&&o<=200||s<=5&&o<=300)&&n.setCursorToEnd()}}))),C(n.props.onMouseDown)&&n.props.onMouseDown(e)},n.onPaste=function(e){C(n.props.onPaste)&&n.props.onPaste(e),e.defaultPrevented||(n.beforePasteState={value:n.getInputValue(),selection:n.getSelection()},n.setInputValue(""))},n.handleRef=function(e){null==n.props.children&&C(n.props.inputRef)&&n.props.inputRef(e)};var a=t.mask,r=t.maskChar,o=t.formatChars,i=t.alwaysShowMask,c=t.beforeMaskedValueChange,v=t.defaultValue,I=t.value;n.maskOptions=d(a,r,o),null==v&&(v=""),null==I&&(I=v);var E=w(I);if(n.maskOptions.mask&&(i||E)&&(E=g(n.maskOptions,E),C(c))){var x=t.value;null==t.value&&(x=v),E=c({value:E,selection:null},{value:x=w(x),selection:null},null,n.getBeforeMaskedValueChangeConfig()).value}return n.value=E,n}!function(e,t){e.prototype=Object.create(t.prototype),function(e,t){for(var n=Object.getOwnPropertyNames(t),a=0;a<n.length;a++){var r=n[a],s=Object.getOwnPropertyDescriptor(t,r);s&&s.configurable&&void 0===e[r]&&Object.defineProperty(e,r,s)}}(e.prototype.constructor=e,t)}(t,e);var n=t.prototype;return n.componentDidMount=function(){this.mounted=!0,this.getInputDOMNode()&&(this.isWindowsPhoneBrowser=function(){var e=new RegExp("windows","i"),t=new RegExp("phone","i"),n=navigator.userAgent;return e.test(n)&&t.test(n)}(),this.maskOptions.mask&&this.getInputValue()!==this.value&&this.setInputValue(this.value))},n.componentDidUpdate=function(){var e=this.previousSelection,t=this.props,n=t.beforeMaskedValueChange,a=t.alwaysShowMask,r=t.mask,s=t.maskChar,o=t.formatChars,l=this.maskOptions,i=a||this.isFocused(),u=null!=this.props.value,c=u?w(this.props.value):this.value,p=e?e.start:null;if(this.maskOptions=d(r,s,o),this.maskOptions.mask){!l.mask&&this.isFocused()&&this.runSaveSelectionLoop();var m=this.maskOptions.mask&&this.maskOptions.mask!==l.mask;if(l.mask||u||(c=this.getInputValue()),(m||this.maskOptions.mask&&(c||i))&&(c=g(this.maskOptions,c)),m){var b=h(this.maskOptions,c);(null===p||b<p)&&(p=v(this.maskOptions,c)?b:k(this.maskOptions,b))}!this.maskOptions.mask||!f(this.maskOptions,c)||i||u&&this.props.value||(c="");var I={start:p,end:p};if(C(n)){var y=n({value:c,selection:I},{value:this.value,selection:this.previousSelection},null,this.getBeforeMaskedValueChangeConfig());c=y.value,I=y.selection}this.value=c;var S=this.getInputValue()!==this.value;S?(this.setInputValue(this.value),this.forceUpdate()):m&&this.forceUpdate();var E=!1;null!=I.start&&null!=I.end&&(E=!e||e.start!==I.start||e.end!==I.end),(E||S)&&this.setSelection(I.start,I.end)}else l.mask&&(this.stopSaveSelectionLoop(),this.forceUpdate())},n.componentWillUnmount=function(){this.mounted=!1,null!==this.selectionDeferId&&S(this.selectionDeferId),this.stopSaveSelectionLoop()},n.render=function(){var e,t=this.props,n=(t.mask,t.alwaysShowMask,t.maskChar,t.formatChars,t.inputRef,t.beforeMaskedValueChange,t.children),a=function(e,t){if(null==e)return{};var n,a,r={},s=Object.keys(e);for(a=0;a<s.length;a++)n=s[a],0<=t.indexOf(n)||(r[n]=e[n]);return r}(t,["mask","alwaysShowMask","maskChar","formatChars","inputRef","beforeMaskedValueChange","children"]);if(n){C(n)||i(!1);var s=["onChange","onPaste","onMouseDown","onFocus","onBlur","value","disabled","readOnly"],l=o({},a);s.forEach((function(e){return delete l[e]})),e=n(l),s.filter((function(t){return null!=e.props[t]&&e.props[t]!==a[t]})).length&&i(!1)}else e=r.createElement("input",o({ref:this.handleRef},a));var u={onFocus:this.onFocus,onBlur:this.onBlur};return this.maskOptions.mask&&(a.disabled||a.readOnly||(u.onChange=this.onChange,u.onPaste=this.onPaste,u.onMouseDown=this.onMouseDown),null!=a.value&&(u.value=this.value)),e=r.cloneElement(e,u)},t}(r.Component);e.exports=E},280:e=>{"use strict";e.exports=window.React},34:e=>{"use strict";e.exports=window.ReactDOM}},t={};function n(a){var r=t[a];if(void 0!==r)return r.exports;var s=t[a]={exports:{}};return e[a](s,s.exports,n),s.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";var e=n(280),t=n(268),a=n.n(t);const r=window.wp.element,{formatPrice:s}=window.wc.priceFormat,o=({optionLabel:e,finalPrice:t,value:n,extraText:a,installmentPrice:r})=>{const o=s(r),l=s(t);return 1===n?`${e} (${o})`:`${n}x ${e} ${o} (${l}) ${a}`.trim()},l=e=>e.map((e=>({label:o(e),value:e.value}))),i=(e,t,n,a,s,o,i)=>{const[u,c]=(0,r.useState)(l(e)),d=(e=>{const t=(0,r.useRef)();return(0,r.useEffect)((()=>{t.current=e})),t.current})(a);return(0,r.useEffect)((()=>{(async()=>{if(2===t&&!n||1===t&&(!d||d===a))return;o(!0);const e=parseFloat(a/100).toFixed(2).replace(".",",");try{const t=await fetch("/wp-admin/admin-ajax.php?"+new URLSearchParams({action:"xqRhBHJ5sW",flag:n,total:e}),{headers:{"X-Request-Type":"Ajax"}});if(!t.ok)return void o(!1);const a=await t.json();if(!a?.installments?.length)return void o(!1);c(l(a.installments)),s(i,1),o(!1)}catch(e){return void o(!1)}})()}),[n,a,t,c,l,s,i]),(0,r.useEffect)((()=>{2===t&&c([{label:"...",value:""}])}),[t,c]),{installmentsOptions:u,filterHandler:e=>{u.filter((t=>t.label.toLowerCase().startsWith(e.toLowerCase())))},installmentsChangeHandler:e=>{s(i,e)}}},{ComboboxControl:u}=wp.components,c=({label:t,installments:n,installmentsType:a,selectedInstallment:r,setSelectedInstallment:s,brand:o,cartTotal:l,setIsLoading:c,cardIndex:d})=>{const{installmentsOptions:p,filterHandler:m,installmentsChangeHandler:f}=i(n,a,o,l,s,c,d);return(0,e.createElement)("div",{className:"wc-block-components-form pagarme-installments-combobox"},(0,e.createElement)("div",{className:"wc-block-components-combobox is-active"},(0,e.createElement)(u,{className:"wc-block-components-combobox-control",label:t,onChange:f,value:r,options:p,onFilterValueChange:m,allowReset:!1,autoComplete:"off"})))};c.propTypes={label:a().string.isRequired,installments:a().array.isRequired,installmentsType:a().number.isRequired,selectedInstallment:a().oneOfType([a().string,a().number]).isRequired,setSelectedInstallment:a().func.isRequired,brand:a().string.isRequired,cartTotal:a().number.isRequired,setIsLoading:a().func.isRequired,cardIndex:a().number.isRequired};const d=c,p=({id:t,label:n,inputValue:a,setInputValue:s,cardIndex:o})=>{const{setIsActive:l,cssClasses:i,inputChangeHandler:u}=((e,t,n)=>{const[a,s]=(0,r.useState)(!1);let o="wc-block-components-text-input";return(a||e.length)&&(o+=" is-active"),{setIsActive:s,cssClasses:o,inputChangeHandler:e=>{const a=e.target.value.replace(/[^a-z ]/gi,"");t(n,a)}}})(a,s,o);return(0,e.createElement)("div",{className:i},(0,e.createElement)("label",{htmlFor:t},n),(0,e.createElement)("input",{type:"text",id:t,value:a,onChange:u,onFocus:()=>l(!0),onBlur:()=>{l(!1)}}))};p.propTypes={id:a().string.isRequired,label:a().string.isRequired,inputValue:a().string.isRequired,setInputValue:a().func.isRequired,cardIndex:a().number.isRequired};const m=p;var f=n(748),h=n.n(f);function v(e){return e.replace(/\s|\*/g,"")}const g=({id:t,label:n,inputValue:a,setInputValue:s,brand:o,setBrand:l,brands:i,setIsLoading:u,cardIndex:c})=>{const{brandImageSrc:d,inputChangeHandler:p,changeBrand:m}=((e,t,n,a,s,o)=>{const[l,i]=(0,r.useState)(""),u=()=>{a(o,""),i("")};return{brandImageSrc:l,inputChangeHandler:e=>{n(o,e.target.value)},changeBrand:async()=>{const n=v(e);if(16!==n.length)return void u();s(!0);const r=n.substring(0,6),l=`https://api.pagar.me/bin/v1/${r}`;try{const e=await fetch(l),n=await e.json();let c=n.brand;if(e.ok&&void 0!==n.brandName||(c=(e=>{let n="",a=null;for(const[r,s]of Object.entries(t))for(const t of s.prefixes){const s=t.toString();0===e.indexOf(s)&&n.length<s.length&&(n=s,a=r)}return a})(r)),null===c)return u(),void s(!1);if(n.brandImage)return i(n.brandImage),s(!1),void a(o,c);i(`https://cdn.mundipagg.com/assets/images/logos/brands/png/${c}.png`),s(!1),a(o,c)}catch(e){return u(),void s(!1)}}}})(a,i,s,l,u,c);return(0,e.createElement)("div",{className:"wc-block-components-text-input is-active"},(0,e.createElement)("label",{htmlFor:t},n),(0,e.createElement)(h(),{className:"pagarme-card-form-card-number",type:"text",id:t,mask:"9999 9999 9999 9999",maskChar:"*",onChange:p,value:a,alwaysShowMask:!0,onBlur:m}),d&&(0,e.createElement)("img",{src:d,alt:o}))};g.propTypes={id:a().string.isRequired,label:a().string.isRequired,inputValue:a().string.isRequired,setInputValue:a().func.isRequired,brand:a().string.isRequired,setBrand:a().func.isRequired,brands:a().object.isRequired,setIsLoading:a().func.isRequired,cardIndex:a().number.isRequired};const b=g,k=({id:t,label:n,inputValue:a,setInputValue:s,cardIndex:o,mask:l,maskChar:i=null})=>{const{setIsActive:u,cssClasses:c,inputChangeHandler:d}=((e,t,n)=>{const[a,s]=(0,r.useState)(!1);let o="wc-block-components-text-input";return(a||e.length)&&(o+=" is-active"),{setIsActive:s,cssClasses:o,inputChangeHandler:e=>{t(n,e.target.value)}}})(a,s,o);return(0,e.createElement)("div",{className:c},(0,e.createElement)("label",{htmlFor:t},n),(0,e.createElement)(h(),{type:"text",id:t,mask:l,maskChar:i,onChange:d,value:a,onFocus:()=>u(!0),onBlur:()=>{u(!1)}}))};k.propTypes={id:a().string.isRequired,label:a().string.isRequired,inputValue:a().string.isRequired,setInputValue:a().func.isRequired,cardIndex:a().number.isRequired,mask:a().string.isRequired,maskChar:a().string};const w=k,{ComboboxControl:C}=wp.components,I=({cards:t,label:n,cardIndex:a,selectedCard:r,setSelectCard:s,setBrand:o})=>{const{filterHandler:l,cardChangeHandler:i}=((e,t,n,a)=>({filterHandler:t=>{e.filter((e=>e.label.toLowerCase().startsWith(t.toLowerCase())))},cardChangeHandler:r=>{n(t,r);const s=e.find((e=>e.value===r));a(t,s?s.brand:"")}}))(t,a,s,o);return(0,e.createElement)("div",{className:"wc-block-components-form pagarme-installments-combobox"},(0,e.createElement)("div",{className:"wc-block-components-combobox is-active"},(0,e.createElement)(C,{className:"wc-block-components-combobox-control",label:n,onChange:i,value:r,options:t,onFilterValueChange:l,allowReset:!1,autoComplete:"off"})))};I.propTypes={cards:a().array.isRequired,label:a().string.isRequired,cardIndex:a().number.isRequired,selectedCard:a().string.isRequired,setSelectCard:a().func.isRequired,setBrand:a().func.isRequired};const y=I,S=window.wp.data,E={holderName:"",number:"",expirationDate:"",installment:1,brand:"",cvv:"",saveCard:!1,walletId:""},x={cards:{1:{...E},2:{...E}}},R=(0,S.createReduxStore)("pagarme-cards",{reducer(e=x,t){switch(t.type){case"SET_PROPERTY_VALUE":return 0===t.propertyName?.length?e:{...e,cards:{...e.cards,[t.cardIndex]:{...e.cards[t.cardIndex],[t.propertyName]:t.value}}};case"RESET":return x}return e},actions:{setHolderName:(e,t)=>({type:"SET_PROPERTY_VALUE",cardIndex:e,value:t,propertyName:"holderName"}),setNumber:(e,t)=>({type:"SET_PROPERTY_VALUE",cardIndex:e,value:t,propertyName:"number"}),setExpirationDate:(e,t)=>({type:"SET_PROPERTY_VALUE",cardIndex:e,value:t,propertyName:"expirationDate"}),setInstallment:(e,t)=>({type:"SET_PROPERTY_VALUE",cardIndex:e,value:t,propertyName:"installment"}),setBrand:(e,t)=>({type:"SET_PROPERTY_VALUE",cardIndex:e,value:t,propertyName:"brand"}),setCvv:(e,t)=>({type:"SET_PROPERTY_VALUE",cardIndex:e,value:t,propertyName:"cvv"}),setSaveCard:(e,t)=>({type:"SET_PROPERTY_VALUE",cardIndex:e,value:t,propertyName:"saveCard"}),setWalletId:(e,t)=>({type:"SET_PROPERTY_VALUE",cardIndex:e,value:t,propertyName:"walletId"}),reset:()=>({type:"RESET"})},selectors:{getHolderName:(e,t)=>e.cards[t].holderName,getNumber:(e,t)=>e.cards[t].number,getExpirationDate:(e,t)=>e.cards[t].expirationDate,getInstallment:(e,t)=>e.cards[t].installment,getBrand:(e,t)=>e.cards[t].brand,getCvv:(e,t)=>e.cards[t].cvv,getSaveCard:(e,t)=>e.cards[t].saveCard,getWalletId:(e,t)=>e.cards[t].walletId,getCards:e=>e.cards}});(0,S.register)(R);const O=R,{CheckboxControl:T}=window.wc.blocksComponents,V=({billing:t,components:n,backendConfig:a,cardIndex:s})=>{const{LoadingMask:o}=n,{holderNameLabel:l,numberLabel:i,expiryLabel:u,cvvLabel:c,installmentsLabel:p,saveCardLabel:f,walletLabel:h}=a.fieldsLabels,{isLoading:v,setIsLoading:g,setHolderName:k,setNumber:C,setExpirationDate:I,setInstallment:E,setBrand:x,setCvv:R,setWalletId:V,saveCardChangeHandler:P,formatFieldId:L,holderName:M,number:D,expirationDate:N,selectedInstallment:q,brand:_,cvv:B,saveCard:F,walletId:j}=(e=>{const[t,n]=(0,r.useState)(!1),{setHolderName:a,setNumber:s,setExpirationDate:o,setInstallment:l,setBrand:i,setCvv:u,setSaveCard:c,setWalletId:d}=(0,S.useDispatch)(O);return{isLoading:t,setIsLoading:n,setHolderName:a,setNumber:s,setExpirationDate:o,setInstallment:l,setBrand:i,setCvv:u,setWalletId:d,saveCardChangeHandler:t=>{c(e,t)},formatFieldId:t=>`pagarme_credit_card_${e}_${t}`,holderName:(0,S.useSelect)((t=>t(O).getHolderName(e)),[e]),number:(0,S.useSelect)((t=>t(O).getNumber(e)),[e]),expirationDate:(0,S.useSelect)((t=>t(O).getExpirationDate(e)),[e]),selectedInstallment:(0,S.useSelect)((t=>t(O).getInstallment(e)),[e]),brand:(0,S.useSelect)((t=>t(O).getBrand(e)),[e]),cvv:(0,S.useSelect)((t=>t(O).getCvv(e)),[e]),saveCard:(0,S.useSelect)((t=>t(O).getSaveCard(e)),[e]),walletId:(0,S.useSelect)((t=>t(O).getWalletId(e)),[e])}})(s);return(0,e.createElement)(o,{isLoading:v},(0,e.createElement)("div",{className:"wc-block-components-form"},a.walletEnabled&&(0,e.createElement)(y,{label:h,selectedCard:j,cards:a.cards,cardIndex:s,setSelectCard:V,setBrand:x}),0===j.length&&(0,e.createElement)(e.Fragment,null,(0,e.createElement)(m,{id:L("holder_name"),label:l,inputValue:M,setInputValue:k,cardIndex:s}),(0,e.createElement)(b,{id:L("number"),label:i,inputValue:D,setInputValue:C,brand:_,setBrand:x,brands:a.brands,setIsLoading:g,cardIndex:s}),(0,e.createElement)(w,{id:L("expiry"),label:u,mask:"99/99",inputValue:N,setInputValue:I,cardIndex:s}),(0,e.createElement)(w,{id:L("cvv"),label:c,mask:"9999",inputValue:B,setInputValue:R,cardIndex:s}),a.walletEnabled&&(0,e.createElement)(T,{label:f,checked:F,onChange:P}))),(0,e.createElement)(d,{label:p,installments:a.installments,installmentsType:a.installmentsType,selectedInstallment:q,setSelectedInstallment:E,brand:_,cartTotal:t.cartTotal.value,setIsLoading:g,cardIndex:s}))};V.propType={billing:a().object.isRequired,components:a().object.isRequired,backendConfig:a().object.isRequired,cardIndex:a().number.isRequired};const P=V;class L extends Error{constructor(e){super(e),this.name=this.constructor.name}}const M=(e,t,n)=>{const a=`${e.replace("request.","")}: ${t}`;return n.hasOwnProperty(a)?n[a]:a};async function D(e,t,n,a,r,s){const[o,l]=n.replace(/\s/g,"").split("/"),i={card:{holder_name:t,number:v(e),exp_month:o,exp_year:l,cvv:a}};try{const e=`https://api.pagar.me/core/v5/tokens?appId=${r}`,t=await fetch(e,{method:"POST",body:JSON.stringify(i)});if(!t.ok){const e=await t.text();if(0===e.length)return{errorMessage:s.serviceUnavailable};const n=((e,t)=>{let n="";for(const a in e.errors)for(const r of e.errors[a]||[])n+=`${M(a,r,t)}<br/>`;return n})(JSON.parse(e),s);return{errorMessage:n}}return{token:(await t.json()).id}}catch(e){return{errorMessage:s.serviceUnavailable}}}const N=(e,t,n)=>{const{reset:a}=(0,S.useDispatch)(O),{onPaymentSetup:s}=n,o=(0,S.useSelect)((e=>e(O).getCards()));(0,r.useEffect)((()=>{a()}),[]),(0,r.useEffect)((()=>s((async()=>{try{const n=await(async(e,t,n)=>{const a=[];for(let r=1;r<t+1;++r){const{holderName:t,number:s,expirationDate:o,cvv:l,brand:i,installment:u,saveCard:c,walletId:d}=e[r];if(d.length>0){a[r]={"wallet-id":d,brand:i,installment:u};continue}const p=await D(s,t,o,l,n.appId,n.errorMessages);if(p.errorMessage)throw L(p.errorMessage);a[r]={token:p.token,brand:i,installment:u},c&&(a[r]["save-card"]=c)}return a})(o,1,e);return{type:t.responseTypes.SUCCESS,meta:{paymentMethodData:{pagarme:JSON.stringify({[e.key]:{cards:{...n}}}),payment_method:e.key}}}}catch(n){let a=e.errorMessages.serviceUnavailable;return n instanceof L&&(a=n.message),{type:t.responseTypes.ERROR,message:a}}}))),[s,o,e])},{registerPaymentMethod:q}=window.wc.wcBlocksRegistry,_=wc.wcSettings.getSetting("woo-pagarme-payments-credit_card_data"),B=t=>{const{emitResponse:n,eventRegistration:a}=t;return N(_,n,a),(0,e.createElement)(P,{...t,backendConfig:_,cardIndex:1})},F=({components:t})=>{const{PaymentMethodLabel:n}=t;return(0,e.createElement)(n,{text:_.label})};B.propTypes={emitResponse:a().object,eventRegistration:a().object},F.propTypes={components:a().object},q({name:_.name,label:(0,e.createElement)(F,null),content:(0,e.createElement)(B,null),edit:(0,e.createElement)(B,null),canMakePayment:()=>!0,ariaLabel:_.ariaLabel})})()})();